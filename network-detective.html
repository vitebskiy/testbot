<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Detective - –î–µ—Ç–µ–∫—Ç–∏–≤ —Å–µ—Ç–∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            background: #0d1117;
            color: #c9d1d9;
            min-height: 100vh;
            padding: 20px;
        }
        
        .terminal {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
            box-shadow: 0 8px 32px rgba(0,0,0,0.4);
        }
        
        .header {
            color: #58a6ff;
            font-size: 18px;
            margin-bottom: 20px;
            border-bottom: 1px solid #30363d;
            padding-bottom: 10px;
        }
        
        .log {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 15px;
            height: 400px;
            overflow-y: auto;
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: 20px;
        }
        
        .log-entry {
            margin: 2px 0;
            padding: 2px 0;
        }
        
        .info { color: #79c0ff; }
        .success { color: #56d364; }
        .warning { color: #f85149; }
        .data { color: #ffa657; }
        .timestamp { color: #8b949e; font-size: 12px; }
        
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .btn {
            background: #238636;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-family: inherit;
            font-size: 14px;
            transition: background 0.2s;
        }
        
        .btn:hover {
            background: #2ea043;
        }
        
        .btn.secondary {
            background: #21262d;
            border: 1px solid #30363d;
        }
        
        .btn.secondary:hover {
            background: #30363d;
        }
        
        .summary {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 15px;
            margin-top: 20px;
        }
        
        .summary h3 {
            color: #58a6ff;
            margin-bottom: 10px;
        }
        
        .summary-item {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            padding: 5px 0;
            border-bottom: 1px solid rgba(48, 54, 61, 0.3);
        }
        
        .summary-value {
            color: #ffa657;
        }
        
        .network-score {
            font-size: 24px;
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            border: 2px solid #30363d;
            border-radius: 8px;
        }
        
        .score-high { border-color: #56d364; color: #56d364; }
        .score-medium { border-color: #ffa657; color: #ffa657; }
        .score-low { border-color: #f85149; color: #f85149; }
    </style>
</head>
<body>
    <div class="terminal">
        <div class="header">
            üïµÔ∏è Network Detective v2.0 - –ê–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
        </div>
        
        <div class="controls">
            <button id="startBtn" class="btn">üîç –ù–∞—á–∞—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</button>
            <button id="clearBtn" class="btn secondary">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
            <button id="saveBtn" class="btn secondary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç</button>
        </div>
        
        <div id="log" class="log">
            <div class="log-entry info">–ì–æ—Ç–æ–≤ –∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é —Å–µ—Ç–∏...</div>
            <div class="log-entry timestamp">[–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞]</div>
        </div>
        
        <div id="summary" class="summary" style="display: none;">
            <h3>üìä –°–≤–æ–¥–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h3>
            <div id="summaryContent"></div>
            
            <div id="networkScore" class="network-score">
                –ê–Ω–∞–ª–∏–∑ –Ω–µ –ø—Ä–æ–≤–æ–¥–∏–ª—Å—è
            </div>
        </div>
        
        <div id="accessResult" style="display: none; margin-top: 20px; padding: 20px; border-radius: 8px; text-align: center;">
            <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ—Å—Ç—É–ø–∞ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
        </div>
    </div>

    <script>
        const log = document.getElementById('log');
        const summaryDiv = document.getElementById('summary');
        const summaryContent = document.getElementById('summaryContent');
        const networkScore = document.getElementById('networkScore');
        const accessResult = document.getElementById('accessResult');
        
        let scanData = {};
        
        function addLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.innerHTML = `<span class="timestamp">[${timestamp}]</span> ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
            console.log(`[${type.toUpperCase()}] ${message}`);
        }
        
        // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
        async function startNetworkScan() {
            addLog('üöÄ –ù–∞—á–∏–Ω–∞–µ–º —Å–µ—Ç–µ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ...', 'info');
            addLog('‚ö†Ô∏è  –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: JavaScript –Ω–µ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ Wi-Fi –Ω–∞–ø—Ä—è–º—É—é', 'warning');
            addLog('üîç –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ—Å–≤–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–µ—Ç–∏...', 'info');
            
            scanData = {};
            
            // 1. –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            await scanBasicInfo();
            
            // 2. –°–µ—Ç–µ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            await scanNetworkInfo();
            
            // 3. WebRTC –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            await scanWebRTC();
            
            // 4. –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è (–µ—Å–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∞)
            await scanGeolocation();
            
            // 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
            await scanNetworkCharacteristics();
            
            // 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
            await scanLocalResources();
            
            // 7. –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            analyzeResults();
            
            addLog('‚úÖ –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!', 'success');
        }
        
        // –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        async function scanBasicInfo() {
            addLog('üìã –°–±–æ—Ä –±–∞–∑–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏...', 'info');
            
            scanData.userAgent = navigator.userAgent;
            scanData.language = navigator.language;
            scanData.platform = navigator.platform;
            scanData.cookieEnabled = navigator.cookieEnabled;
            scanData.onLine = navigator.onLine;
            scanData.timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
            scanData.screen = {
                width: screen.width,
                height: screen.height,
                colorDepth: screen.colorDepth
            };
            
            addLog(`üì± –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: ${scanData.platform}`, 'data');
            addLog(`üåç –Ø–∑—ã–∫: ${scanData.language}`, 'data');
            addLog(`üïí –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å: ${scanData.timezone}`, 'data');
            addLog(`üì∫ –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ: ${scanData.screen.width}x${scanData.screen.height}`, 'data');
        }
        
        // –°–µ—Ç–µ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        async function scanNetworkInfo() {
            addLog('üåê –ê–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...', 'info');
            
            if ('connection' in navigator) {
                const conn = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
                scanData.connection = {
                    type: conn.type || 'unknown',
                    effectiveType: conn.effectiveType || 'unknown',
                    downlink: conn.downlink || 'unknown',
                    rtt: conn.rtt || 'unknown',
                    saveData: conn.saveData || false
                };
                
                addLog(`üì° –¢–∏–ø –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ${scanData.connection.type}`, 'data');
                addLog(`‚ö° –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π —Ç–∏–ø: ${scanData.connection.effectiveType}`, 'data');
                addLog(`üìä –°–∫–æ—Ä–æ—Å—Ç—å: ${scanData.connection.downlink} Mbps`, 'data');
                addLog(`‚è±Ô∏è  RTT: ${scanData.connection.rtt} ms`, 'data');
            } else {
                addLog('‚ùå Network Information API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω', 'warning');
                scanData.connection = null;
            }
        }
        
        // WebRTC –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ IP
        async function scanWebRTC() {
            addLog('üîç –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ IP —á–µ—Ä–µ–∑ WebRTC...', 'info');
            
            return new Promise((resolve) => {
                try {
                    const pc = new RTCPeerConnection({
                        iceServers: [
                            {urls: 'stun:stun.l.google.com:19302'},
                            {urls: 'stun:stun1.l.google.com:19302'}
                        ]
                    });
                    
                    const ips = new Set();
                    
                    pc.createDataChannel('');
                    pc.createOffer().then(offer => pc.setLocalDescription(offer));
                    
                    pc.onicecandidate = (event) => {
                        if (event.candidate) {
                            const candidate = event.candidate.candidate;
                            const ipMatch = candidate.match(/([0-9]{1,3}(\.[0-9]{1,3}){3})/);
                            
                            if (ipMatch) {
                                const ip = ipMatch[1];
                                if (!ips.has(ip)) {
                                    ips.add(ip);
                                    addLog(`üåê –û–±–Ω–∞—Ä—É–∂–µ–Ω IP: ${ip}`, 'data');
                                    
                                    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–¥—Å–µ—Ç—å
                                    let subnet = 'unknown';
                                    if (ip.startsWith('192.168.1.')) subnet = '192.168.1.x (–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –¥–æ–º–∞—à–Ω—è—è)';
                                    else if (ip.startsWith('192.168.0.')) subnet = '192.168.0.x (–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –¥–æ–º–∞—à–Ω—è—è)';
                                    else if (ip.startsWith('10.0.0.')) subnet = '10.0.0.x (–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è/VPN)';
                                    else if (ip.startsWith('172.16.')) subnet = '172.16.x.x (–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è)';
                                    else if (ip.startsWith('169.254.')) subnet = '169.254.x.x (APIPA/–∞–≤—Ç–æ–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)';
                                    else subnet = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –ø–æ–¥—Å–µ—Ç—å';
                                    
                                    addLog(`üìç –ü–æ–¥—Å–µ—Ç—å: ${subnet}`, 'data');
                                }
                            }
                        }
                    };
                    
                    scanData.localIPs = [];
                    
                    setTimeout(() => {
                        scanData.localIPs = Array.from(ips);
                        pc.close();
                        
                        if (ips.size === 0) {
                            addLog('‚ùå –õ–æ–∫–∞–ª—å–Ω—ã–µ IP –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã', 'warning');
                        }
                        
                        resolve();
                    }, 3000);
                    
                } catch (error) {
                    addLog(`‚ùå WebRTC –æ—à–∏–±–∫–∞: ${error.message}`, 'warning');
                    scanData.localIPs = [];
                    resolve();
                }
            });
        }
        
        // –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è
        async function scanGeolocation() {
            addLog('üìç –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏...', 'info');
            
            return new Promise((resolve) => {
                if ('geolocation' in navigator) {
                    navigator.geolocation.getCurrentPosition(
                        (position) => {
                            scanData.geolocation = {
                                latitude: position.coords.latitude,
                                longitude: position.coords.longitude,
                                accuracy: position.coords.accuracy
                            };
                            addLog(`üìç –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: ${position.coords.latitude.toFixed(6)}, ${position.coords.longitude.toFixed(6)}`, 'data');
                            addLog(`üéØ –¢–æ—á–Ω–æ—Å—Ç—å: ${position.coords.accuracy} –º–µ—Ç—Ä–æ–≤`, 'data');
                            resolve();
                        },
                        (error) => {
                            addLog(`‚ùå –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞: ${error.message}`, 'warning');
                            scanData.geolocation = null;
                            resolve();
                        },
                        { timeout: 5000, enableHighAccuracy: false }
                    );
                } else {
                    addLog('‚ùå Geolocation API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω', 'warning');
                    scanData.geolocation = null;
                    resolve();
                }
            });
        }
        
        // –°–µ—Ç–µ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
        async function scanNetworkCharacteristics() {
            addLog('‚ö° –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ç–µ–≤—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫...', 'info');
            
            const tests = [
                { url: 'https://www.google.com/favicon.ico', name: 'Google' },
                { url: 'https://httpbin.org/delay/0', name: 'HTTPBin' },
                { url: 'https://jsonplaceholder.typicode.com/posts/1', name: 'JSONPlaceholder' }
            ];
            
            scanData.latencies = {};
            
            for (const test of tests) {
                try {
                    const start = performance.now();
                    await fetch(test.url, { method: 'HEAD', cache: 'no-cache' });
                    const latency = Math.round(performance.now() - start);
                    
                    scanData.latencies[test.name] = latency;
                    addLog(`‚è±Ô∏è  ${test.name}: ${latency} ms`, 'data');
                    
                } catch (error) {
                    addLog(`‚ùå ${test.name}: –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω`, 'warning');
                    scanData.latencies[test.name] = null;
                }
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
        async function scanLocalResources() {
            addLog('üè† –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤...', 'info');
            
            const localIPs = [
                '192.168.1.1',
                '192.168.0.1',
                '10.0.0.1',
                '172.16.0.1',
                '192.168.1.254'
            ];
            
            scanData.localResources = {};
            
            const promises = localIPs.map(async (ip) => {
                try {
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 2000);
                    
                    await fetch(`http://${ip}`, {
                        method: 'HEAD',
                        mode: 'no-cors',
                        signal: controller.signal
                    });
                    
                    clearTimeout(timeoutId);
                    scanData.localResources[ip] = true;
                    addLog(`‚úÖ ${ip}: –¥–æ—Å—Ç—É–ø–µ–Ω`, 'success');
                    
                } catch (error) {
                    scanData.localResources[ip] = false;
                    addLog(`‚ùå ${ip}: –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω`, 'data');
                }
            });
            
            await Promise.allSettled(promises);
        }
        
        // –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        function analyzeResults() {
            addLog('üß† –ê–Ω–∞–ª–∏–∑ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö...', 'info');
            
            let score = 0;
            let analysis = [];
            
            // –ê–Ω–∞–ª–∏–∑ IP-–∞–¥—Ä–µ—Å–æ–≤
            if (scanData.localIPs && scanData.localIPs.length > 0) {
                const nppdozaIndicators = scanData.localIPs.some(ip => 
                    ip.startsWith('192.168.1.') || 
                    ip.startsWith('192.168.0.') ||
                    ip.startsWith('10.0.0.')
                );
                
                if (nppdozaIndicators) {
                    score += 30;
                    analysis.push('IP –∞–¥—Ä–µ—Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–µ–º—ã–º –ø–æ–¥—Å–µ—Ç—è–º NPPDOZA');
                }
            }
            
            // –ê–Ω–∞–ª–∏–∑ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞
            if (scanData.timezone === 'Europe/Moscow') {
                score += 20;
                analysis.push('–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—é NPPDOZA');
            }
            
            // –ê–Ω–∞–ª–∏–∑ —è–∑—ã–∫–∞
            if (scanData.language.startsWith('ru')) {
                score += 10;
                analysis.push('–†—É—Å—Å–∫–∏–π —è–∑—ã–∫ —Å–∏—Å—Ç–µ–º—ã');
            }
            
            // –ê–Ω–∞–ª–∏–∑ –∑–∞–¥–µ—Ä–∂–∫–∏
            const avgLatency = scanData.latencies.Google;
            if (avgLatency && avgLatency < 50) {
                score += 25;
                analysis.push('–ù–∏–∑–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ —Å–µ—Ç–∏ (—Ö–æ—Ä–æ—à–µ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ)');
            } else if (avgLatency && avgLatency < 100) {
                score += 15;
                analysis.push('–£–º–µ—Ä–µ–Ω–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ —Å–µ—Ç–∏');
            }
            
            // –ê–Ω–∞–ª–∏–∑ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
            const accessibleRouters = Object.values(scanData.localResources).filter(v => v).length;
            if (accessibleRouters > 0) {
                score += 15;
                analysis.push(`–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ ${accessibleRouters} –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤`);
            }
            
            scanData.finalScore = score;
            scanData.analysis = analysis;
            
            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            displayResults(score, analysis);
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        function displayResults(score, analysis) {
            // –°–≤–æ–¥–∫–∞
            summaryContent.innerHTML = '';
            
            const items = [
                ['–õ–æ–∫–∞–ª—å–Ω—ã–µ IP', scanData.localIPs ? scanData.localIPs.join(', ') : '–ù–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã'],
                ['–¢–∏–ø –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è', scanData.connection ? scanData.connection.type : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'],
                ['–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å', scanData.timezone],
                ['–ó–∞–¥–µ—Ä–∂–∫–∞ –¥–æ Google', scanData.latencies.Google ? `${scanData.latencies.Google} ms` : '–ù/–î'],
                ['–õ–æ–∫–∞–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã', Object.values(scanData.localResources).filter(v => v).length + ' –¥–æ—Å—Ç—É–ø–Ω–æ'],
                ['–ê–Ω–∞–ª–∏–∑', analysis.length > 0 ? analysis.join('; ') : '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö']
            ];
            
            items.forEach(([key, value]) => {
                const item = document.createElement('div');
                item.className = 'summary-item';
                item.innerHTML = `<span>${key}:</span><span class="summary-value">${value}</span>`;
                summaryContent.appendChild(item);
            });
            
            // –û—Ü–µ–Ω–∫–∞
            let scoreClass = 'score-low';
            let verdict = '–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω';
            let verdictColor = '#f85149';
            
            if (score >= 70) {
                scoreClass = 'score-high';
                verdict = '–î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω - –≤–µ—Ä–æ—è—Ç–Ω–æ —Å–µ—Ç—å NPPDOZA';
                verdictColor = '#56d364';
            } else if (score >= 40) {
                scoreClass = 'score-medium';
                verdict = '–î–æ—Å—Ç—É–ø –ø–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º - –≤–æ–∑–º–æ–∂–Ω–æ —Å–µ—Ç—å NPPDOZA';
                verdictColor = '#ffa657';
            }
            
            networkScore.className = `network-score ${scoreClass}`;
            networkScore.innerHTML = `–û—Ü–µ–Ω–∫–∞ —Å–µ—Ç–∏: ${score}/100<br><small>${verdict}</small>`;
            
            // –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ—Å—Ç—É–ø–∞
            accessResult.style.display = 'block';
            accessResult.style.backgroundColor = verdictColor + '20';
            accessResult.style.border = `2px solid ${verdictColor}`;
            accessResult.style.color = verdictColor;
            accessResult.innerHTML = `
                <h2>${score >= 70 ? '‚úÖ' : score >= 40 ? '‚ö†Ô∏è' : '‚ùå'} ${verdict}</h2>
                <p>–ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞: ${score}/100</p>
                ${score >= 70 ? '<div style="margin-top: 20px; padding: 20px; background: rgba(86, 211, 100, 0.1); border-radius: 8px;"><h3>üéâ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∑–∞–∫—Ä—ã—Ç—ã–π –∫–∞–Ω–∞–ª NPPDOZA!</h3><p>–°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∞ –≤—ã—Å–æ–∫—É—é –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –≤ —Ü–µ–ª–µ–≤–æ–π —Å–µ—Ç–∏.</p></div>' : ''}
            `;
            
            summaryDiv.style.display = 'block';
            
            addLog(`üéØ –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞: ${score}/100`, score >= 70 ? 'success' : score >= 40 ? 'warning' : 'warning');
            addLog(`üìã –í–µ—Ä–¥–∏–∫—Ç: ${verdict}`, score >= 70 ? 'success' : 'warning');
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        document.getElementById('startBtn').addEventListener('click', startNetworkScan);
        
        document.getElementById('clearBtn').addEventListener('click', () => {
            log.innerHTML = '<div class="log-entry info">–õ–æ–≥ –æ—á–∏—â–µ–Ω. –ì–æ—Ç–æ–≤ –∫ –Ω–æ–≤–æ–º—É —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é...</div>';
            summaryDiv.style.display = 'none';
            accessResult.style.display = 'none';
        });
        
        document.getElementById('saveBtn').addEventListener('click', () => {
            const data = {
                timestamp: new Date().toISOString(),
                scanData: scanData,
                logEntries: Array.from(log.children).map(el => el.textContent)
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `network-scan-${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            addLog('üíæ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª', 'success');
        });
        
        // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', () => {
            addLog('üöÄ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã...', 'info');
            setTimeout(startNetworkScan, 2000);
        });
    </script>
</body>
</html>
